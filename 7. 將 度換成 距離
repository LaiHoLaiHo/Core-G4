
#讀檔案

import pandas as pd

B = []
import csv
f = open('1change.csv', 'r')
for row in csv.reader(f):
    B.append(row)
f.close()

#build a dataframe


B1 = pd.DataFrame(B, columns=['id','Ra','Dec','zbest', 'groupodd', 'groupeven'])
#因為輸出為字串，要做數據處理要將之轉換為浮點數

Raf = pd.to_numeric(B1.Ra, errors = 'ingnore')

Decf = pd.to_numeric(B1.Dec, errors = 'ingnore')

B1.insert(1, 'Raf', Raf)

B1.insert(2, 'Decf', Decf)

'''自己印
print(B1[:10])
           id        Raf      Decf         Ra       Dec   zbest groupodd  \
0   NEPW10000  267.77960  66.43983   267.7796  66.43983  0.1467        1   
1  NEPW100004  273.34695  66.39777  273.34695  66.39777  0.2924        1   
2  NEPW100007  273.34720  66.55110   273.3472   66.5511  0.2391        1   
3   NEPW10002  267.77975  66.34745  267.77975  66.34745  0.2954        1   
4  NEPW100029  273.35269  66.69381  273.35269  66.69381   0.117        1   
5  NEPW100031  273.35394  66.51744  273.35394  66.51744  0.1751        1   
6  NEPW100034  273.35492  66.30582  273.35492  66.30582  0.2431        1   
7  NEPW100036  273.35544  66.62951  273.35544  66.62951   0.136        1   
8  NEPW100065  273.35992  66.30569  273.35992  66.30569   0.205        1   
9  NEPW100071  273.36154  66.32886  273.36154  66.32886  0.1567        1   

  groupeven  
0         0  
1         2  
2         2  
3         2  
4         0  
5         0  
6         2  
7         0  
8         2  
9         0  
'''

#將源字串刪除
del B1['Ra']

del B1['Dec']
'''
print(B1[:10])
           id        Raf      Decf   zbest groupodd groupeven
0   NEPW10000  267.77960  66.43983  0.1467        1         0
1  NEPW100004  273.34695  66.39777  0.2924        1         2
2  NEPW100007  273.34720  66.55110  0.2391        1         2
3   NEPW10002  267.77975  66.34745  0.2954        1         2
4  NEPW100029  273.35269  66.69381   0.117        1         0
5  NEPW100031  273.35394  66.51744  0.1751        1         0
6  NEPW100034  273.35492  66.30582  0.2431        1         2
7  NEPW100036  273.35544  66.62951   0.136        1         0
8  NEPW100065  273.35992  66.30569   0.205        1         2
9  NEPW100071  273.36154  66.32886  0.1567        1         0
'''

#以  Ra 270 當作中心  DEC  66.5  當作中心
#先算與中心距離多少度

Rax = B1.Raf-270.0

Decy = B1.Decf-66.5

B1['Rax'] = Rax

B1['Decy'] = Decy

'''
print(B1[:10])
           id        Raf      Decf   zbest groupodd groupeven      Rax  \
0   NEPW10000  267.77960  66.43983  0.1467        1         0 -2.22040   
1  NEPW100004  273.34695  66.39777  0.2924        1         2  3.34695   
2  NEPW100007  273.34720  66.55110  0.2391        1         2  3.34720   
3   NEPW10002  267.77975  66.34745  0.2954        1         2 -2.22025   
4  NEPW100029  273.35269  66.69381   0.117        1         0  3.35269   
5  NEPW100031  273.35394  66.51744  0.1751        1         0  3.35394   
6  NEPW100034  273.35492  66.30582  0.2431        1         2  3.35492   
7  NEPW100036  273.35544  66.62951   0.136        1         0  3.35544   
8  NEPW100065  273.35992  66.30569   0.205        1         2  3.35992   
9  NEPW100071  273.36154  66.32886  0.1567        1         0  3.36154   

      Decy  
0 -0.06017  
1 -0.10223  
2  0.05110  
3 -0.15255  
4  0.19381  
5  0.01744  
6 -0.19418  
7  0.12951  
8 -0.19431  
9 -0.17114  
'''
import math

##如同EXCEl一樣，做整個直行的公式計算將度換弧度
Decrad = B1.Decf*2*math.pi/360

B1['Decrad'] = Decrad
'''
print(B1[:10])
           id        Raf      Decf   zbest groupodd groupeven      Rax  \
0   NEPW10000  267.77960  66.43983  0.1467        1         0 -2.22040   
1  NEPW100004  273.34695  66.39777  0.2924        1         2  3.34695   
2  NEPW100007  273.34720  66.55110  0.2391        1         2  3.34720   
3   NEPW10002  267.77975  66.34745  0.2954        1         2 -2.22025   
4  NEPW100029  273.35269  66.69381   0.117        1         0  3.35269   
5  NEPW100031  273.35394  66.51744  0.1751        1         0  3.35394   
6  NEPW100034  273.35492  66.30582  0.2431        1         2  3.35492   
7  NEPW100036  273.35544  66.62951   0.136        1         0  3.35544   
8  NEPW100065  273.35992  66.30569   0.205        1         2  3.35992   
9  NEPW100071  273.36154  66.32886  0.1567        1         0  3.36154   

      Decy    Decrad  
0 -0.06017  1.159594  
1 -0.10223  1.158860  
2  0.05110  1.161536  
3 -0.15255  1.157981  
4  0.19381  1.164027  
5  0.01744  1.160948  
6 -0.19418  1.157255  
7  0.12951  1.162904  
8 -0.19431  1.157253  
9 -0.17114  1.157657  
'''

cosDec = []

#因為球座標關係，要乘COS  建議自己想一下，不懂再問我
for i in Decrad:
    cosDec.append(math.cos(i))
    

cosDec = pd.DataFrame(cosDec, columns=['cosDec'])

B1['cosDec'] = cosDec
'''
print(B1[:10])
           id        Raf      Decf   zbest groupodd groupeven      Rax  \
0   NEPW10000  267.77960  66.43983  0.1467        1         0 -2.22040   
1  NEPW100004  273.34695  66.39777  0.2924        1         2  3.34695   
2  NEPW100007  273.34720  66.55110  0.2391        1         2  3.34720   
3   NEPW10002  267.77975  66.34745  0.2954        1         2 -2.22025   
4  NEPW100029  273.35269  66.69381   0.117        1         0  3.35269   
5  NEPW100031  273.35394  66.51744  0.1751        1         0  3.35394   
6  NEPW100034  273.35492  66.30582  0.2431        1         2  3.35492   
7  NEPW100036  273.35544  66.62951   0.136        1         0  3.35544   
8  NEPW100065  273.35992  66.30569   0.205        1         2  3.35992   
9  NEPW100071  273.36154  66.32886  0.1567        1         0  3.36154   

      Decy    Decrad    cosDec  
0 -0.06017  1.159594  0.399712  
1 -0.10223  1.158860  0.400385  
2  0.05110  1.161536  0.397931  
3 -0.15255  1.157981  0.401189  
4  0.19381  1.164027  0.395645  
5  0.01744  1.160948  0.398470  
6 -0.19418  1.157255  0.401855  
7  0.12951  1.162904  0.396675  
8 -0.19431  1.157253  0.401857  
9 -0.17114  1.157657  0.401487  
'''

#終於要換距離了  在z(紅移) = 0.2 那邊「視角」 一度  等於 3.171 千角秒差(kpc/") 等於 3.6*3.171 百萬角秒差(Mpc/degree) 就是 R = r*d theta(弧長計算)
B1['Rad'] = B1.Rax*3.6*3.171*B1.cosDec

B1['Decd'] = B1.Decy*3.6*3.171
'''
print(B1[:10])
           id        Raf      Decf   zbest groupodd groupeven      Rax  \
0   NEPW10000  267.77960  66.43983  0.1467        1         0 -2.22040   
1  NEPW100004  273.34695  66.39777  0.2924        1         2  3.34695   
2  NEPW100007  273.34720  66.55110  0.2391        1         2  3.34720   
3   NEPW10002  267.77975  66.34745  0.2954        1         2 -2.22025   
4  NEPW100029  273.35269  66.69381   0.117        1         0  3.35269   
5  NEPW100031  273.35394  66.51744  0.1751        1         0  3.35394   
6  NEPW100034  273.35492  66.30582  0.2431        1         2  3.35492   
7  NEPW100036  273.35544  66.62951   0.136        1         0  3.35544   
8  NEPW100065  273.35992  66.30569   0.205        1         2  3.35992   
9  NEPW100071  273.36154  66.32886  0.1567        1         0  3.36154   

      Decy    Decrad    cosDec        Rad      Decd  
0 -0.06017  1.159594  0.399712 -10.131577 -0.686877  
1 -0.10223  1.158860  0.400385  15.297675 -1.167017  
2  0.05110  1.161536  0.397931  15.205062  0.583337  
3 -0.15255  1.157981  0.401189 -10.168338 -1.741450  
4  0.19381  1.164027  0.395645  15.142498  2.212457  
5  0.01744  1.160948  0.398470  15.256312  0.199088  
6 -0.19418  1.157255  0.401855  15.390404 -2.216681  
7  0.12951  1.162904  0.396675  15.194388  1.478434  
8 -0.19431  1.157253  0.401857  15.413421 -2.218165  
9 -0.17114  1.157657  0.401487  15.406642 -1.953666  
'''

#看圖

import matplotlib.pyplot as plt
plt.scatter(B1.Rad, B1.Decd, s = 0.03)
plt.show()


 #存檔

B1.to_csv('distance_bin1.csv', index = False)
